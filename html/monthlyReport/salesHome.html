<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <!-- 引入echarts -->
    <script type="text/javascript" src="../../incubator-echarts-4.6.0/dist/echarts.min.js"></script>
    <script type="text/javascript" src="../../incubator-echarts-4.6.0/map/js/china.js"></script>
    <!--     <script src="https://cdn.bootcss.com/echarts/4.2.1-rc1/echarts.min.js"></script> -->
    <style>

    </style>
</head>

<body>
    <div
        style="width:100%;height:618px;position:absolute;background:url(../../img/middleBorder.png) no-repeat 100% 100%">
    </div>
    <div id="salesHomeEcharts" class="swiper-slide swiper-slide-echarts" style="width: 858px;height:594px;"></div>
    <script>
        var monthShow = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
        var allData = {
            // 预测假数据
            revenue_forecast_usd_data: [
                { x: "Nov", y: 181839280.998621, labelTooltip: "Monthly Sales" },
                { x: "Dec", y: 205400000, labelTooltip: "Sales Forecast" }
            ],
            // 今年的数据
            actual_sales_data: [
                { x: "Jan", y: 259182182.448299, labelTooltip: "Monthly Sales" },
                { x: "Feb", y: 141008903.613831, labelTooltip: "Monthly Sales" },
                { x: "Mar", y: 186254864.365569, labelTooltip: "Monthly Sales" },
                { x: "Apr", y: 163577009.942271, labelTooltip: "Monthly Sales" },
                { x: "May", y: 167704246.1877, labelTooltip: "Monthly Sales" },
                { x: "Jun", y: 157906823.07325, labelTooltip: "Monthly Sales" },
                { x: "Jul", y: 154569943.579371, labelTooltip: "Monthly Sales" },
                { x: "Aug", y: 167639863.957207, labelTooltip: "Monthly Sales" },
                { x: "Sep", y: 231611473.006812, labelTooltip: "Monthly Sales" },
                { x: "Oct", y: 186714599.278695, labelTooltip: "Monthly Sales" },
                { x: "Nov", y: 181839280.998621, labelTooltip: "Monthly Sales" }
            ],
            // 去年的数据
            actual_sales_ly_data: [
                { x: "Jan", y: 220148225.348956, labelTooltip: "Monthly Sales Last Year" },
                { x: "Feb", y: 220029133.037112, labelTooltip: "Monthly Sales Last Year" },
                { x: "Mar", y: 191906223.932465, labelTooltip: "Monthly Sales Last Year" },
                { x: "Apr", y: 187582766.562842, labelTooltip: "Monthly Sales Last Year" },
                { x: "May", y: 186091372.77103, labelTooltip: "Monthly Sales Last Year" },
                { x: "Jun", y: 179788691.045646, labelTooltip: "Monthly Sales Last Year" },
                { x: "Jul", y: 183970140.209618, labelTooltip: "Monthly Sales Last Year" },
                { x: "Aug", y: 177614966.795802, labelTooltip: "Monthly Sales Last Year" },
                { x: "Sep", y: 232577346.147572, labelTooltip: "Monthly Sales Last Year" },
                { x: "Oct", y: 201336344.638635, labelTooltip: "Monthly Sales Last Year" },
                { x: "Nov", y: 190356725.93657, labelTooltip: "Monthly Sales Last Year" },
                { x: "Dec", y: 208842233.540768, labelTooltip: "Monthly Sales Last Year" }
            ],
            // 备注和提示内容
            tooltip_data_map: []
        }
        var thisYear = [];
        var lastYear = [];
        var forecastYear = [];
        var tooltipData = allData.tooltip_data_map
        // console.log(allData.tooltip_data_map)
        if (allData && allData.actual_sales_data.length > 0) {
            allData.actual_sales_data.map((item, index) => {
                thisYear.push(item.y)
            })
        }
        if (allData && allData.actual_sales_ly_data.length > 0) {
            allData.actual_sales_ly_data.map((item, index) => {
                lastYear.push(item.y)
            })
        }
        if (allData && allData.revenue_forecast_usd_data.length > 0) {
            allData.revenue_forecast_usd_data.map((item, index) => {
                forecastYear.push(item.y)
            })
        }
        for (var i = 0; forecastYear.length < 12; i++) {
            forecastYear.unshift("")
        }
        handleEcharts();
        function handleEcharts() {
            var salesHomeEcharts = echarts.init(document.getElementById('salesHomeEcharts'));
            window.addEventListener('resize', function () {
                salesHomeEcharts.resize()
            });
            salesHomeEcharts.setOption({
                title: [
                    {
                        text: 'Salse($)',
                        x: '0',
                        y: '0',
                        textStyle: {                  //标题样式
                            fontSize: '18',
                            color: '#333333',
                        },
                    }
                ],
                tooltip: {//鼠标移入
                    trigger: 'axis',
                    confine: true,
                    //                 tooltip_data_map:
                    // Jan:
                    // monthName: "2019 January"
                    // actual_sales: "$277m"
                    // actual_sales_ly: "$235m"
                    // sales_forecast: null
                    // events: (3) ["Olive Oil Launch", "Nutrilite XS Jan Promotion", "Olive Oil Experience"]
                    formatter: (data) => {
                        // console.log(data)
                        var yearThisData = 0;
                        var yearLastData = 0;
                        var forecastData = 0;
                        var nameShow = "";
                        var toolShow = "";
                        var monthUp = "";
                        var yearUp = new Date().getFullYear()
                        data.map((item, index) => {
                            if (item.componentIndex && item.componentIndex == 1) {
                                yearThisData = Math.round((item.data || 0) / 1000000) || 0
                            } else if (item.componentIndex && item.componentIndex == 2) {
                                yearLastData = Math.round((item.data || 0) / 1000000) || 0
                            } else {
                                forecastData = Math.round((item.data || 0) / 1000000) || 0
                            }
                            nameShow = item.name
                            monthUp = item.axisValue
                        })
                        if (yearThisData) {
                            var thisNow = "Monthly Sales This Year:" + yearThisData;
                        } else {
                            var thisNow = "Sales forecast:" + forecastData;
                        }
                        if (tooltipData && tooltipData[nameShow]) {
                            tooltipData[nameShow].events.map((item, index) => {
                                toolShow += "<div style='display:flex;justify-content: space-between'><span style='color:#f2df3f'>" + "★" + "</span>" + item + "</div>"
                            })
                        }
                        return "<div style='border-bottom:1px solid #ffffff'>" + yearUp + "  " + monthUp + "</div>" + "<div style='border-bottom:1px solid #ffffff'>" + thisNow + "m" + "<br/>" + "Monthly Sales Last Year:" + yearLastData + "m" + "</div>" + toolShow
                    }
                },
                grid: {
                    top: '18%',
                    left: '2%',
                    right: '5%',
                    bottom: '10%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: monthShow,
                    axisTick: {
                        show: false //隐藏X轴刻度
                    },
                    axisLine: {
                        show: false,
                    },
                    boundaryGap: false,//X轴刻度位置
                    axisLabel: {
                        textStyle: {
                            fontSize: 12,
                            color: '#666'
                        },
                        formatter: function (params) {
                            return params.split(' ')[0]
                        }
                    }
                },
                yAxis: [
                    {
                        type: 'value',
                        axisLabel: {
                            show: true,
                            textStyle: {
                                color: "#666"
                            },
                            formatter: function (params) {
                                return params / 1000000 + "m"
                            }
                        },
                        axisLine: {//隐藏X轴
                            show: false
                        },
                        axisTick: {
                            show: false //隐藏X轴刻度
                        },
                        splitLine: {//Y轴的样式虚线
                            lineStyle: {
                                type: 'dashed',
                                color: '#e5e9ee'
                            }
                        }
                    }
                ],
                series: [
                    {
                        name: 'Sales forecast',
                        type: 'line',
                        symbolSize: 5,   //拐点圆的大小
                        // color:['#fd0022'],  //折线条的颜色
                        data: forecastYear,
                        // symbol: "none", //去掉折线点
                        smooth: false,   //关键点，为true是不支持虚线的，实线就用true
                        itemStyle: {
                            normal: {
                                lineStyle: {
                                    width: 3,
                                    type: 'dotted',  //'dotted'虚线 'solid'实线
                                    color: "#ff9c46"
                                },
                            }
                        },
                        // label: {
                        //     show: true,
                        //     position: 'top',
                        //     textStyle: {
                        //         color: '#fd0022',
                        //     },
                        //     formatter: function (params) {
                        //         console.log(params)
                        //         return params.data / 1000000 + "m"
                        //     }
                        // },
                    }, {
                        name: "Monthly Sales This Year",
                        data: thisYear,
                        type: 'line',
                        smooth: true,
                        // symbol: "none", //去掉折线点
                        symbolSize: 5, //折线点的大小
                        label: {
                            show: true,
                            // position: 'top',
                            position: ['0', '-20'],
                            formatter: function (params) {
                                return Math.round((params.data || 0) / 1000000) + "m"
                            },
                            backgroundColor: '#5198ee',
                            borderRadius: 5,
                            padding: 4,
                            textStyle: {
                                fontSize: 8,
                                color: '#ffffff',
                            }
                        },
                        // stack: 100,
                        itemStyle: {
                            normal: { //颜色渐变函数 前四个参数分别表示四个位置依次为左、下、右、上
                                //     // color: 'rgba(253,0,34,0.1)', //背景渐变色
                                lineStyle: { // 系列级个性化折线样式
                                    width: 3,
                                    type: 'solid',
                                    color: "#5198ee"//折现颜色
                                },
                                borderColor: '#5198ee',  // 拐点边框颜色
                            },
                            // emphasis: {
                            //     color: '#fd0022',
                            //     lineStyle: { // 系列级个性化折线样式
                            //         width: 0.5,
                            //         type: 'dotted',
                            //         color: "#fd0022" //折线的颜色
                            //     }
                            // }
                        }, //线条样式
                    }, {
                        name: "Monthly Sales Last Year",
                        data: lastYear,
                        type: 'line',
                        smooth: true,
                        symbol: "none", //去掉折线点
                        symbolSize: 5, //折线点的大小
                        stack: 100,
                        itemStyle: {
                            normal: { //颜色渐变函数 前四个参数分别表示四个位置依次为左、下、右、上
                                color: 'rgba(211,212,214,0.36)', //背景渐变色
                                lineStyle: { // 系列级个性化折线样式
                                    width: 0.5,
                                    type: 'solid',
                                    color: "rgba(211,212,214,0.36)"//折现颜色
                                }
                            },
                        }, //线条样式
                        areaStyle: {
                            normal: {}
                        },
                    }
                ],
                //图例名
                legend: {
                    type: "scroll",
                    icon: "line",
                    left: 'center',
                    bottom: 'bottom',
                    // y: '220',
                    textStyle: {
                        color: "#666",
                        fontSize: 10
                    },
                },
                //  legend: {//图例组件
                //     x: '35',
                //     y: '421',
                //     show: true,
                //     textStyle: {//图例的公用文本样式。
                //         fontSize: 24,
                //         color: "#8D99A4"
                //     },
                //     itemGap: 20,//图例每项之间的间隔。横向布局时为水平间隔，纵向布局时为纵向间隔。
                //     data: ['活动金额', '流向实际毛利'],//图例的数据数组。
                //     inactiveColor: '#ccc',//图例关闭时的颜色。
                // },
            })
        }
    </script>
</body>

</html>